---
title: "Protein Classification"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Protein Classification}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

In our analysis, we'll gather structural data from PolBase and KLIFS databases, focusing on DNA polymerases and kinases, respectively. We'll classify proteins into families and compare their structures, plotting amino acid proportions and analyzing sequence lengths. Our R package will streamline data cleaning, leveraging Tidyverse functions and a protein class to enhance organization and reusability.

Challenges may arise in parsing complex PDB files, but we'll address them using filtering techniques and substring searches. Our analysis offers educational value, providing people with insights into protein structure-function relationships and empowering them to explore and compare protein structures using our R package.

# Installation
The `protein555` package has package dependencies on `bio3d`, `devtools` and `ggplot2`. These should be installed if not downloaded prior. To use the `protein5555` package, you'll need to install it from GitHub using the `devtools` package. This can be done by following this link to the GitHub repository: https://github.com/EmelineHaroldsen/protein5555.git

Once installed, you can load the protein5555 package in your R session using the following command:

```{r}
library(protein5555)
```

# Usage with Example Data

In this section, we'll demonstrate how to use the `protein5555` package to analyze protein structures and perform comparative analyses. We will show this using the built in datasets in this package, however using your own PDB file is compatible with this package. 

## Description of Datasets

The `protein5555` package has 6 built-in datasets (bqr, fpu, huo, qgy, r7g, and sl0). Each dataset contains a protein sequence.
Three of the protein sequences (bqr, huo, sl0) came from the PolBase database and RSCB PDB and are representative of a fraction of polymerase sequences.
The remaining three protein sequences (fpu, qgy, r7g) came from the KLIFS database and RSCB PDB and are representative of a fraction of kinase sequences.

## Load example datasets
Below, we have loaded the RData files from this package and called a constructor to assign the `protein5555` class to each protein. Furthermore, called a constructor to assign the `protein5555_list` class to a list of each protein object. 
```{r}
a <- protein5555(bqr, "pol")
b <- protein5555(fpu, "kin")
d <- protein5555(huo, "pol")
e <- protein5555(qgy, "kin")
f <- protein5555(r7g, "kin")
g <- protein5555(sl0, "pol")

kin_pol <- protein5555_list(list(a, b, d, e, f, g))
```

## Summary statistics
There is a built in summary statistic of the function that is compatible with the `protein5555_list` class.  
If the summary is of an individual protein the summary function returns the family of the protein and some statistics about the proportion of amino acids of the protein sequence which are polar, nonpolar, charged, etc.
If the summary is of protein list, it will return the families in the list, and some summary statistics about the proportion of amino acids (in the whole list) which are polar, nonpolar, charged, etc.
```{r}
summary(a)
summary(kin_pol)
```

## Plot amino acid proportions
There are several plotting functions. Below, we show plotting the respective protein families, (polymerase and kinase) and the amino acid frequencies in each family. As an example, we also plot the amino acid frequencies of a single protein.
```{r, warning=FALSE}
plot(kin_pol)
plot(a)
```

## Plot by Charge or Polarity
The charge and polarity plots that allow you to compare the percentage of amino acids within protein families that are charged or polar.
```{r}
plot(kin_pol, kind = "polar")

plot(kin_pol, kind = "charge")
```


## Compare sequence lengths between DNA polymerases and kinases
This plotting function, we see a boxplot of the total sequence lengths of each protein family.
```{r}
plot(kin_pol, kind = "length")
```

# Using Data to Clean & Classify
There are functions built into the `protein5555` package that allow for a pbd file to be entered and the longest protein string to be selected. There are typically two strings, labeled A or B, and the `cleaner` function will return which string was selected while storing the longer protein sequence. The classify sequence allows for the various 20 amino acids to be classified with polarity and the type of charge. 

Since a data frame is returned from the classify function, only the first 6 lines will be shown as an example. 
```{r}
head(classify(huo))
```

# Conclusion
In conclusion, the `protein5555` package is beneficial for those looking to take complex protein structure data from PolBase and KLIFS (pdb file types) and gather insights about DNA polymerases and kinases.

This package is beneficial as it helps classify proteins into families to compare their structures and analyzing amino acid proportions. There are multiple plotting functions that allow for visualizations to be used to polarity and the charge of individual amino acids. 
