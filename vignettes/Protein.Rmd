---
title: "Protein Classification"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Protein Classification}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(ggplot2)
```

# Introduction

In our analysis, we'll gather structural data from PolBase and KLIFS databases, focusing on DNA polymerases and kinases, respectively. We'll classify proteins into families and compare their structures, plotting amino acid proportions and analyzing sequence lengths. Our R package will streamline data cleaning, leveraging Tidyverse functions and a protein class to enhance organization and reusability.

Challenges may arise in parsing complex PDB files, but we'll address them using filtering techniques and substring searches. Our analysis offers educational value, providing people with insights into protein structure-function relationships and empowering them to explore and compare protein structures using our R package.

# Installation
The `protein555` package has package dependencies on `bio3d`, `devtools` and `ggplot2`. These should be installed if not downloaded prior. To use the `protein5555` package, you'll need to install it from GitHub using the `devtools` package. This can be done by following this link to the GitHub repository: https://github.com/EmelineHaroldsen/protein5555.git

Once installed, you can load the protein5555 package in your R session using the following command:

```{r}
library(protein5555)
```

# Usage with Example Data

In this section, we'll demonstrate how to use the `protein5555` package to analyze protein structures and perform comparative analyses. We will show this using the built in datasets in this package, however using your own PDB file is compatible with this package. 

## Description of Datasets

We'll provide two example datasets:
1. `dna_pol_data`: Structural data from DNA polymerases obtained from the PolBase database.
2. `kinase_data`: Structural data from kinases obtained from the KLIFS database.

## Load example datasets
Below, we have loaded the RData files from this package and called a constructor to assign the `protein5555_list` class to the data. 
```{r}
data("clean_bqr")
data("clean_fpu")
data("clean_huo")
data("clean_qgy")
data("clean_r7g")
data("clean_sl0")

a <- protein5555(bqr, "pol")
b <- protein5555(fpu, "kin")
d <- protein5555(huo, "pol")
e <- protein5555(qgy, "kin")
f <- protein5555(r7g, "pol")
g <- protein5555(sl0, "pol")

kin_pol <- protein5555_list(list(a, b, d, e, f, g))
```

## Classifying proteins into families
Below, we can check the class of the individual data as a `protein5555` or the list of the individual proteins as a list. 
```{r}
class(a)
class(kin_pol)
```

## Summary statistics
There is a built in summary statistic of the function that is compatitble with the `protein5555_list` class.  
```{r}
summary(kin_pol)
```

## Plot amino acid proportions
There are several plotting functions. Below, we show plotting the respective protein families, polymerase and kinase and the frequencies that are seen from the combined 6 datasets in this package. The number of the various amino acids are also plotted. 
```{r}
plot(kin_pol)
plot(a)
```

## Compare sequence lengths between DNA polymerases and kinases
This plotting function, where the kind is chosen from "charge", "length" or "polar", we see the total sequence length from the two various protein families. 
```{r}
plot(kin_pol, kind = "length")
```

# Using Data to Clean & Classify
There are functions built into the `protein5555` package tha allow for a pbd file to be entered and the longest protein string to be selected. There are typically two strings, labeled A or B, and the `cleaner` function will return which string was selected while storing the longer protein sequence. The classify sequence allows for the various 20 amino acids to be classified with polarity and the type of charge. 

# Conclusion

That wraps up our tour of the `protein5555` package! We've seen how it can turn complex protein structure data from PolBase and KLIFS into insights about DNA polymerases and kinases.

From classifying proteins into families to comparing their structures and analyzing amino acid proportions, this package makes it easy to dive into protein structure-function relationships. And don't worry about those tricky PDB files - we've got you covered with filtering techniques and substring searches.
