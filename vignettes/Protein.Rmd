---
title: "Protein Classification"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Protein Classification}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

Our analysis delves into the rich structural data sourced from esteemed repositories like PolBase and KLIFS databases, with a targeted focus on DNA polymerases and kinases. These proteins play pivotal roles in fundamental biological processes, orchestrating DNA replication and signaling cascades critical for cellular function and regulation. Understanding their structural intricacies is paramount for unraveling their physiological significance and potential therapeutic applications.

Parsing the wealth of information encapsulated within complex PDB files presents formidable challenges. The intricate nature of these files demands sophisticated filtering techniques and substring searches to extract relevant data effectively. Our endeavor is to surmount these challenges by offering a comprehensive R package that not only facilitates the extraction and manipulation of structural data but also empowers users to glean actionable insights from their analyses.

At the heart of our package lies a suite of functionalities meticulously designed to streamline data cleaning and analysis. Leveraging the robust capabilities of Tidyverse functions, our package provides a seamless pathway for organizing and preparing data for in-depth exploration. Through a dedicated protein class, users can effortlessly classify proteins into distinct families, paving the way for comparative analyses and structural elucidation.

Crucially, our package serves as more than just a tool for data manipulation; it is a gateway to understanding the intricate relationships between protein structure and function. By plotting amino acid proportions and analyzing sequence lengths, users gain valuable insights into the underlying principles governing protein biology. These visualizations not only facilitate scientific inquiry but also serve as educational resources, empowering individuals to navigate the complex landscape of protein structures with confidence and clarity.

In essence, our analysis and package offer a compelling opportunity to delve into the fascinating world of protein biology. By providing a robust framework for data exploration and analysis, we aim to catalyze discoveries, foster scientific curiosity, and drive advancements in biomedical research and beyond.

# Installation
The `protein555` package has package dependencies on `bio3d`, `devtools` and `ggplot2`. These should be installed if not downloaded prior. To use the `protein5555` package, you'll need to install it from GitHub using the `devtools` package. This can be done by following this link to the GitHub repository: https://github.com/EmelineHaroldsen/protein5555.git

Once installed, you can load the protein5555 package in your R session using the following command:

```{r}
library(protein5555)
```

# Usage with Example Data

In this section, we'll demonstrate how to use the `protein5555` package to analyze protein structures and perform comparative analyses. We will show this using the built in datasets in this package, however using your own PDB file is compatible with this package. 

## Description of Datasets

The `protein5555` package has 6 built-in datasets (bqr, fpu, huo, qgy, r7g, and sl0). Each dataset contains a protein sequence.
Three of the protein sequences (bqr, huo, sl0) came from the PolBase database and RSCB PDB and are representative of a fraction of polymerase sequences.
The remaining three protein sequences (fpu, qgy, r7g) came from the KLIFS database and RSCB PDB and are representative of a fraction of kinase sequences.

## Load Example Datasets
Below, we have loaded the RData files from this package and called a constructor to assign the `protein5555` class to each protein. Furthermore, called a constructor to assign the `protein5555_list` class to a list of each protein object. 
```{r}
a <- protein5555(bqr, "pol")
b <- protein5555(fpu, "kin")
d <- protein5555(huo, "pol")
e <- protein5555(qgy, "kin")
f <- protein5555(r7g, "kin")
g <- protein5555(sl0, "pol")

kin_pol <- protein5555_list(list(a, b, d, e, f, g))
```

## Summary Statistics
There is a built in summary statistic of the function that is compatible with the `protein5555_list` class.  
If the summary is of an individual protein the summary function returns the family of the protein and some statistics about the proportion of amino acids of the protein sequence which are polar, nonpolar, charged, etc.
If the summary is of protein list, it will return the families in the list, and some summary statistics about the proportion of amino acids (in the whole list) which are polar, nonpolar, charged, etc.
```{r}
summary(a)
summary(kin_pol)
```

## Plot Amino Acid Proportions
There are several plotting functions. Below, we show plotting the respective protein families, (polymerase and kinase) and the amino acid frequencies in each family. As an example, we also plot the amino acid frequencies of a single protein.
```{r, warning=FALSE}
plot(kin_pol)
plot(a)
```

## Plot by Charge or Polarity
The charge and polarity plots that allow you to compare the percentage of amino acids within protein families that are charged or polar.
```{r}
plot(kin_pol, kind = "polar")

plot(kin_pol, kind = "charge")
```


## Compare Sequence Lengths Between DNA Polymerases and Kinases
This plotting function, we see a boxplot of the total sequence lengths of each protein family.
```{r}
plot(kin_pol, kind = "length")
```

# Using Data to Clean and Classify
There are functions built into the `protein5555` package that allow for a pbd file to be entered and the longest protein string to be selected. There are typically two strings, labeled A or B, and the `cleaner` function will return which string was selected while storing the longer protein sequence. The classify sequence allows for the various 20 amino acids to be classified with polarity and the type of charge. 

Since a data frame is returned from the classify function, only the first 6 lines will be shown as an example. 
```{r}
head(classify(huo))
```

# Conclusion
In conclusion, the `protein5555` package proves invaluable to individuals seeking to navigate the intricacies of protein structure data sourced from PolBase and KLIFS databases, particularly in the PDB file format. This software facilitates the extraction of profound insights into the realm of DNA polymerases and kinases.

The utility of this package stems from its adeptness in classifying proteins into distinct families, enabling comprehensive comparisons of their structural attributes. Furthermore, it offers robust tools for scrutinizing amino acid proportions, thereby augmenting the depth of analysis. 

Notably, the package boasts a repertoire of plotting functions tailored to illuminate the polarity and charge distribution of individual amino acids. These visualizations serve as indispensable aids in unraveling the intricate nuances of protein composition and behavior.

In summation, the `protein5555` package stands as a commendable asset for researchers and enthusiasts alike, poised to illuminate the complexities inherent in protein structures and functionalities.
