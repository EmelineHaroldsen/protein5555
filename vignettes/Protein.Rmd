---
title: "Protein Classification"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Protein Classification}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

In our analysis, we'll gather structural data from PolBase and KLIFS databases, focusing on DNA polymerases and kinases, respectively. We'll classify proteins into families and compare their structures, plotting amino acid proportions and analyzing sequence lengths. Our R package will streamline data cleaning, leveraging Tidyverse functions and a protein class to enhance organization and reusability.

Challenges may arise in parsing complex PDB files, but we'll address them using filtering techniques and substring searches. Our analysis offers educational value, providing people with insights into protein structure-function relationships and empowering them to explore and compare protein structures using our R package.

# Installation
The `protein555` package has package dependencies on `bio3d`, `devtools` and `ggplot2`. These should be installed if not downloaded prior. To use the `protein5555` package, you'll need to install it from GitHub using the `devtools` package. Follow these steps:

```{r, warning=FALSE, echo = FALSE}
library(ggplot2)
# Install the protein5555 package from GitHub
devtools::install_github("EmelineHaroldsen/protein5555")
```

Once installed, you can load the protein5555 package in your R session using the following command:

```{r}
library(protein5555)
```

# Usage

In this section, we'll demonstrate how to use the `protein5555` package to analyze protein structures and perform comparative analyses.

## Example Data

In this section, we'll use example datasets built into this package to demonstrate the functionality of the `protein5555` package. 

## Description of Datasets

We'll provide two example datasets:
1. `dna_pol_data`: Structural data from DNA polymerases obtained from the PolBase database.
2. `kinase_data`: Structural data from kinases obtained from the KLIFS database.

## Load example datasets
```{r}
data("clean_bqr")
data("clean_fpu")
data("clean_huo")
data("clean_qgy")
data("clean_r7g")
data("clean_sl0")

a <- protein5555(bqr, "pol")
b <- protein5555(fpu, "kin")
d <- protein5555(huo, "pol")
e <- protein5555(qgy, "kin")
f <- protein5555(r7g, "pol")
g <- protein5555(sl0, "pol")

kinPol <- protein5555_list(list(a, b, d, e, f, g))
```

## Classifying proteins into families
```{r}
class(a)
class(kinPol)
```
## Using Own Protein Data PDB File
Alternatively, if you have your own dataset, there are functions in this package that support. You can call `cleanser` and input the pdb file location and it will pull out the sequence of proteins that is the longest and can be analyzed.
```{r, eval=TRUE, echo=FALSE, warning = FALSE}
invisible(pdb_file <- here::here("data", "Pol", "1huo.pdb"))
```

```{r}
cleaner(pdb_file)
protein5555(cleaner(pdb_file), "pol")
summary(protein5555(cleaner(pdb_file), "pol"))
```

## Summary statistics
```{r}
summary(kinPol)
```

## Plot amino acid proportions
```{r}
plot(kinPol)
plot(a)
```

## Compare sequence lengths between DNA polymerases and kinases
```{r}
plot(kinPol, kind = "length")
```

# Conclusion

That wraps up our tour of the `protein5555` package! We've seen how it can turn complex protein structure data from PolBase and KLIFS into insights about DNA polymerases and kinases.

From classifying proteins into families to comparing their structures and analyzing amino acid proportions, this package makes it easy to dive into protein structure-function relationships. And don't worry about those tricky PDB files - we've got you covered with filtering techniques and substring searches.

But it's not just about getting results; it's about learning too. By exploring and comparing protein structures, you can deepen your understanding of molecular biology concepts and maybe even uncover something new!

Looking ahead, we've got big plans for `protein5555`. More databases, better visualizations, and maybe even some machine learning magic - the sky's the limit!

So go ahead, give `protein5555` a spin, and let us know what you think. Your feedback and ideas are what make this package tick. Head over to our GitHub repository to get started, and join the community of protein structure enthusiasts!

Thanks for joining us on this adventure, and happy exploring!
